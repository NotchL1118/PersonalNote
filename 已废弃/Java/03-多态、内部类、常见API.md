# 多态、内部类、常见API

# 七、多态

## 7.1多态的概述、多态的形式

###	7.1.1 什么是多态

- 同类的对象，执行同一个行为，会表现出不同的行为特征

###	7.1.2 多态的常见形式

```java
父类类型 对象名称 = new 子类构造器
接口 对象名称 = new 实现类构造器
```

例如：

```java
Animal a = new dog();//其中dog类是Animal的子类
```



###	7.1.3 多态中成员访问特点

- **方法调用：** 编译看左边，运行看右边
- **变量调用：** 编译看左边，运行也看左边

> **多态侧重行为多态**

###	7.1.4 多态的前提

- 有继承/实现关系；有父类引用指向子类对象；有方法重写

###	7.1.5 多态的优势

- 在多态形式下，右边对象可以实现解耦合，便于拓展和维护。

例如原本的代码:

```java
Animal a = new dog();
a.run();
```

后续业务如果发现变化，后续代码无需修改，只需改成
```java
Animal a = new cat();
a.run();//后续业务行为随对象而变，后续代码无需修改
```

- 定义方法的时候，使用父类作为参数，该方法就可以接受这父类的一切子类对象，体现出多态的拓展性与便利。

```java
public static void go(Animal a)
{
    a.run();
}
dog a = new dog();
go(a);
//上述成立或者是
Animal a = new dog();
go(a);
//也是成立的
```

## 7.2 多态引用数据类型的类型转换

###	7.2.1类型转换的种类

- 多态下不能使用子类的独有功能，所以需要类型转换，一共有2种类型

1. **自动类型转换(从子到父)：**子类对象赋值给父类类型的变量指向
2. **强制类型转换(从父到子)：**

- 子类 对象变量 = （子类）父类类型的变量

```java
Animal a = new dog()；
dog b = (dog)a;
//然后可以调用子类dog独有功能
```

### 7.2.2 类型转换作用以及注意点

- **作用:**可以解决多态的问题，可以实现调用子类独有的功能。

- **注意点：**如果转型后的类型和对象真实类型不是同一个类型，那么在转换时候会出现`ClassCastException`

```java
Animal a = new cat();
dog b = dog(a);//出现异常ClassCastException
//有继承或实现关系，此时编译阶段不报错，运行时可能出错！！
```

- **为避免上一个问题，在强制转化前使用`instanceof`判断当前对象的真实类型，再进行强制转换**

```java
变量名 instanceof 真实类型
判断关键字左边的变量指向的对象的真实类型，是否是右边的类型或者其子类类型，是就返回true，反之false.
```

```java
Animal a = new dog();
if(a instanceof dog)
{
    dog b = (dog)a;
}
```

# 八、内部类

## 8.1 内部类概述

- 内部类就是一个类中的类，里面的类可以理解成(寄生)，外部类可以理解成(宿主)。

```java
public class People {
    //内部类
    public class Heart{
    }
}
```

### 8.1.1 内部类的使用场景

- 当一个事务的内部，还有一个部分需要一个完整的结构需要描述时。

### 8.1.2 内部类的基本作用

- 内部类通常可以方便访问外部类的成员，包括私有的成员
- 内部类提供了更好的封装性，内部类本身就可以用`private`,`protected`等修饰，封装性可控。



## 8.2 内部类的分类

### 8.2.1 静态内部类(了解)

- 有static修饰，属于外部类本身。
- 特点和使用与普通类是完全一样的，类的成分都具备，位置在别的类里面而已。

```java
public class Outer {
    //静态内部类
    public static class Inner{
    }
}
```

- 静态内部类创建对象的格式:

`外部类名.内部类名 对象名 = new 外部类名.内部类构造器；`

例子：`Outer.Inner in = new Outer.Inner();`

注意:

- 静态内部类可以直接访问外部类的静态成员。
- 静态内部类不可以直接访问外部类的实例成员，必须用外部类对象访问。
- **使用较少**

### 8.2.2 成员内部类(了解)

- 无static修饰，属于外部类的对象。
- **JDK16之前，成员内部类中不能定义静态成员**

```java
public class Outer {
    //成员内部类
    public class Inner{
        
    }
}
```

- 创建格式

`外部类名.内部类名 对象名 = new 外部类构造器.new 内部类构造器();`

例子：`Outer.Inner in = new Outer().new Inner();`

注意:

- 成员内部类可以直接访问外部类的静态成员
- 成员内部类的实例方法可以直接访问外部类的实例成员

补充:

- 在成员内部类中访问所在外部类对象，格式: **外部类名.this**

### 8.2.3 匿名内部类(重点)

- 本质是一个没有名字的局部内部类
- 作用：方便创建子类对象，最终目的是为了简化代码编写

格式:

```java
new 类|抽象类名|接口名 (){
    重写方法;
};
```

```java
Employee a = new Employee(){
    public void work(){
        
    }
};
a.work();
```

特点：

- 匿名内部类写出来就会产生一个匿名内部类的对象
- 匿名内部类产生的对象类型，相当于是当前new的那个类型
- 匿名内部类可以作为一个对象，直接传输给方法

# 九、 常见API

## 9.1 Object类

作用：

- 一个类要么默认继承了Object类，要么间接继承，Object类是Java中的祖宗类
- Object作为所有类的父类，提供很多常见的方法给每个子类对象使用

常用方法:

| 方法名                          | 说明                                                         |
| ------------------------------- | ------------------------------------------------------------ |
| public String toString()        | 默认方法当前对象在堆内存中的地址信息类:类的全限名@内存地址   |
| public boolean equals(Object o) | 默认是比较当前对象与另一个对象的地址是否相同，相同返回true，不同返回false |

### 9.1.1 toString类

问题：

- 开发中直接输出对象，默认输出对象的地址无意义
- 开发中输出对象变量，希望看到对象的内容数据

作用：

- 父类toString()存在意义方便被子类重写，以便返回对象的内容信息



### 9.1.2 equals方法

问题：

- 直接比较两个对象的地址可以用 `==`来替代
- 开发中，更想比较2个对象的内容是否一样

作用：

- 方便被子类重写，以便子类自定义比较规则(比如比较对象内容)



## 9.2 Objects类

- Objects是一个工具类，提供了一些方法

方法:

| 方法名                                          | 说明                                                         |
| ----------------------------------------------- | ------------------------------------------------------------ |
| public static boolean equals(Object a,Object b) | 比较两个对象，底层会先进行非空判断，避免空指针异常，再进行equals比较 |
| public static boolean isNull(Object obj)        | 判断变量是否为null，为null返回true，犯之false                |



## 9.3 StringBuilder

- StringBuilder是一个**可变**的字符串的操作类，可以看成是一个对象容器
- 使用StringBuilder操作字符串的性能币String更高

构造器：

| 名称                             | 说明                                           |
| -------------------------------- | ---------------------------------------------- |
| public StringBuilder()           | 创建一个空白的可变的字符串对象，不包含任何内容 |
| public StringBuilder(String str) | 创建一个指定字符串的可变字符串对象             |

常用方法:

| 方法名称                              | 说明                                                |
| ------------------------------------- | --------------------------------------------------- |
| public StringBuilder append(任意类型) | 添加数据并返回StringBuilder对象本身                 |
| public StringBuilder reverse()        | 将对象内容反转                                      |
| public int length()                   | 返回对象内容长度                                    |
| public String toString()              | 通过toString()就可以实现把StringBuilder转换为String |

